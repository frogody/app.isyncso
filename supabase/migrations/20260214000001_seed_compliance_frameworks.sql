-- SENTINEL - Seed compliance frameworks and controls
-- These are template controls that get copied per-company when a framework is enabled

-- ============================================================
-- FRAMEWORK TEMPLATES (company_id = NULL = global templates)
-- ============================================================
INSERT INTO public.compliance_frameworks (id, company_id, slug, name, description, version, category, region, icon, color, total_controls)
VALUES
  ('00000000-0000-0000-0001-000000000001', NULL, 'soc2', 'SOC 2 Type II', 'Service Organization Control 2 — Trust Service Criteria for security, availability, processing integrity, confidentiality, and privacy', '2017', 'security', 'global', 'Shield', 'blue', 64),
  ('00000000-0000-0000-0001-000000000002', NULL, 'iso27001', 'ISO 27001:2022', 'International standard for information security management systems (ISMS)', '2022', 'security', 'global', 'Award', 'indigo', 93),
  ('00000000-0000-0000-0001-000000000003', NULL, 'gdpr', 'GDPR', 'General Data Protection Regulation — EU data protection and privacy law', '2016/679', 'privacy', 'eu', 'Lock', 'purple', 40),
  ('00000000-0000-0000-0001-000000000004', NULL, 'eu-ai-act', 'EU AI Act', 'European Union Artificial Intelligence Act — Risk-based AI regulation', '2024/1689', 'ai-governance', 'eu', 'Brain', 'sage', 35),
  ('00000000-0000-0000-0001-000000000005', NULL, 'nis2', 'NIS2 Directive', 'Network and Information Security Directive 2 — Cybersecurity for essential and important entities', '2022/2555', 'security', 'eu', 'Network', 'cyan', 25),
  ('00000000-0000-0000-0001-000000000006', NULL, 'hipaa', 'HIPAA', 'Health Insurance Portability and Accountability Act — US healthcare data protection', '1996', 'privacy', 'us', 'Heart', 'red', 50),
  ('00000000-0000-0000-0001-000000000007', NULL, 'pci-dss', 'PCI DSS v4.0', 'Payment Card Industry Data Security Standard', '4.0', 'security', 'global', 'CreditCard', 'amber', 64),
  ('00000000-0000-0000-0001-000000000008', NULL, 'dora', 'DORA', 'Digital Operational Resilience Act — ICT risk management for EU financial entities', '2022/2554', 'resilience', 'eu', 'Building', 'emerald', 30)
ON CONFLICT DO NOTHING;

-- ============================================================
-- SOC 2 CONTROLS (Trust Service Criteria)
-- ============================================================
INSERT INTO public.compliance_controls (id, framework_id, company_id, control_ref, title, description, category, severity, automated, implementation_guidance)
VALUES
-- Common Criteria (CC) - Security
('10000000-0001-0000-0000-000000000001', '00000000-0000-0000-0001-000000000001', NULL, 'CC1.1', 'Integrity and Ethical Values', 'The entity demonstrates a commitment to integrity and ethical values', 'control-environment', 'high', false, 'Establish and communicate a code of conduct. Provide ethics training annually.'),
('10000000-0001-0000-0000-000000000002', '00000000-0000-0000-0001-000000000001', NULL, 'CC1.2', 'Board Independence and Oversight', 'The board of directors demonstrates independence from management and exercises oversight', 'control-environment', 'medium', false, 'Document board charter and meeting minutes. Ensure independent oversight of security program.'),
('10000000-0001-0000-0000-000000000003', '00000000-0000-0000-0001-000000000001', NULL, 'CC1.3', 'Management Structure and Authority', 'Management establishes structures, reporting lines, authorities, and responsibilities', 'control-environment', 'high', false, 'Document org chart with security roles. Define RACI matrix for security functions.'),
('10000000-0001-0000-0000-000000000004', '00000000-0000-0000-0001-000000000001', NULL, 'CC1.4', 'Competence Commitment', 'The entity demonstrates commitment to attract, develop, and retain competent individuals', 'control-environment', 'medium', false, 'Maintain job descriptions with security responsibilities. Track security training completion.'),
('10000000-0001-0000-0000-000000000005', '00000000-0000-0000-0001-000000000001', NULL, 'CC1.5', 'Accountability', 'The entity holds individuals accountable for their internal control responsibilities', 'control-environment', 'medium', false, 'Include security metrics in performance reviews. Document escalation procedures.'),
('10000000-0001-0000-0000-000000000006', '00000000-0000-0000-0001-000000000001', NULL, 'CC2.1', 'Information Quality', 'The entity obtains or generates relevant, quality information to support functioning of internal controls', 'communication', 'medium', false, 'Maintain asset inventory. Document data classification policy.'),
('10000000-0001-0000-0000-000000000007', '00000000-0000-0000-0001-000000000001', NULL, 'CC2.2', 'Internal Communication', 'The entity internally communicates information necessary to support functioning of controls', 'communication', 'medium', false, 'Regular security communications. Distribute policies to all employees.'),
('10000000-0001-0000-0000-000000000008', '00000000-0000-0000-0001-000000000001', NULL, 'CC2.3', 'External Communication', 'The entity communicates with external parties regarding matters affecting internal controls', 'communication', 'medium', false, 'Publish security contact. Maintain vulnerability disclosure program.'),
('10000000-0001-0000-0000-000000000009', '00000000-0000-0000-0001-000000000001', NULL, 'CC3.1', 'Risk Objectives', 'The entity specifies objectives with sufficient clarity to enable identification and assessment of risks', 'risk-assessment', 'high', false, 'Document security objectives aligned with business goals. Review annually.'),
('10000000-0001-0000-0000-000000000010', '00000000-0000-0000-0001-000000000001', NULL, 'CC3.2', 'Risk Identification and Analysis', 'The entity identifies risks and analyzes their significance', 'risk-assessment', 'critical', false, 'Conduct annual risk assessment. Maintain risk register with likelihood and impact ratings.'),
('10000000-0001-0000-0000-000000000011', '00000000-0000-0000-0001-000000000001', NULL, 'CC3.3', 'Fraud Risk', 'The entity considers the potential for fraud in assessing risks', 'risk-assessment', 'high', false, 'Include fraud scenarios in risk assessment. Monitor for unauthorized access patterns.'),
('10000000-0001-0000-0000-000000000012', '00000000-0000-0000-0001-000000000001', NULL, 'CC3.4', 'Change Management', 'The entity identifies and assesses changes that could significantly impact internal controls', 'risk-assessment', 'high', true, 'Maintain change management process. Track infrastructure and application changes.'),
('10000000-0001-0000-0000-000000000013', '00000000-0000-0000-0001-000000000001', NULL, 'CC4.1', 'Monitoring Activities', 'The entity selects, develops, and performs ongoing evaluations to verify controls are present and functioning', 'monitoring', 'critical', true, 'Implement continuous monitoring dashboards. Automate control testing where possible.'),
('10000000-0001-0000-0000-000000000014', '00000000-0000-0000-0001-000000000001', NULL, 'CC4.2', 'Deficiency Communication', 'The entity evaluates and communicates internal control deficiencies in a timely manner', 'monitoring', 'high', false, 'Track deficiencies in issue tracker. Establish remediation timelines.'),
('10000000-0001-0000-0000-000000000015', '00000000-0000-0000-0001-000000000001', NULL, 'CC5.1', 'Control Activities Selection', 'The entity selects and develops control activities that mitigate risks', 'control-activities', 'high', false, 'Map controls to identified risks. Document control procedures.'),
('10000000-0001-0000-0000-000000000016', '00000000-0000-0000-0001-000000000001', NULL, 'CC5.2', 'Technology Controls', 'The entity selects and develops general control activities over technology', 'control-activities', 'critical', true, 'Implement access controls, change management, and operations monitoring for all technology.'),
('10000000-0001-0000-0000-000000000017', '00000000-0000-0000-0001-000000000001', NULL, 'CC5.3', 'Policy Deployment', 'The entity deploys control activities through policies and procedures', 'control-activities', 'high', false, 'Publish all security policies. Track employee acknowledgment.'),
('10000000-0001-0000-0000-000000000018', '00000000-0000-0000-0001-000000000001', NULL, 'CC6.1', 'Logical Access Security', 'The entity implements logical access security over protected information assets', 'logical-access', 'critical', true, 'Enforce MFA. Implement SSO. Role-based access control. Regular access reviews.'),
('10000000-0001-0000-0000-000000000019', '00000000-0000-0000-0001-000000000001', NULL, 'CC6.2', 'Access Provisioning', 'Prior to issuing credentials, the entity registers and authorizes new users', 'logical-access', 'critical', true, 'Formal access request and approval process. Manager approval required for all access.'),
('10000000-0001-0000-0000-000000000020', '00000000-0000-0000-0001-000000000001', NULL, 'CC6.3', 'Access Removal', 'The entity removes access that is no longer required and reviews appropriateness of access', 'logical-access', 'critical', true, 'Automate offboarding access removal. Quarterly access reviews. Remove within 24h of termination.'),
('10000000-0001-0000-0000-000000000021', '00000000-0000-0000-0001-000000000001', NULL, 'CC6.6', 'System Boundaries', 'The entity implements logical access security to protect against threats from external sources', 'logical-access', 'high', true, 'Configure firewalls, WAF, VPN. Network segmentation. IDS/IPS monitoring.'),
('10000000-0001-0000-0000-000000000022', '00000000-0000-0000-0001-000000000001', NULL, 'CC6.7', 'Data Transmission Security', 'The entity restricts the transmission of data to authorized channels', 'logical-access', 'high', true, 'Enforce TLS 1.2+. Encrypt data in transit. DLP controls for sensitive data.'),
('10000000-0001-0000-0000-000000000023', '00000000-0000-0000-0001-000000000001', NULL, 'CC6.8', 'Malware Prevention', 'The entity implements controls to prevent or detect and act upon introduction of malware', 'logical-access', 'high', true, 'Endpoint protection on all devices. Automated malware scanning. Security awareness training.'),
('10000000-0001-0000-0000-000000000024', '00000000-0000-0000-0001-000000000001', NULL, 'CC7.1', 'Infrastructure Monitoring', 'To meet its objectives, the entity uses detection and monitoring procedures to identify changes to configurations', 'system-operations', 'critical', true, 'Monitor infrastructure changes. Alert on unauthorized modifications. Log aggregation.'),
('10000000-0001-0000-0000-000000000025', '00000000-0000-0000-0001-000000000001', NULL, 'CC7.2', 'Security Event Monitoring', 'The entity monitors system components for anomalies indicative of malicious acts or natural disasters', 'system-operations', 'critical', true, 'SIEM implementation. 24/7 alerting for security events. Threat detection rules.'),
('10000000-0001-0000-0000-000000000026', '00000000-0000-0000-0001-000000000001', NULL, 'CC7.3', 'Security Event Evaluation', 'The entity evaluates security events to determine whether they could or have resulted in failure', 'system-operations', 'critical', false, 'Incident triage process. Severity classification. Root cause analysis.'),
('10000000-0001-0000-0000-000000000027', '00000000-0000-0000-0001-000000000001', NULL, 'CC7.4', 'Incident Response', 'The entity responds to identified security incidents by executing a defined incident response program', 'system-operations', 'critical', false, 'Documented incident response plan. Defined roles and communication channels. Post-incident review.'),
('10000000-0001-0000-0000-000000000028', '00000000-0000-0000-0001-000000000001', NULL, 'CC7.5', 'Incident Recovery', 'The entity identifies, develops, and implements activities to recover from identified security incidents', 'system-operations', 'high', false, 'Disaster recovery plan. Business continuity procedures. Recovery time objectives.'),
('10000000-0001-0000-0000-000000000029', '00000000-0000-0000-0001-000000000001', NULL, 'CC8.1', 'Change Management Process', 'The entity authorizes, designs, develops, configures, documents, tests, approves, and implements changes to meet objectives', 'change-management', 'critical', true, 'Formal change request process. Code review requirements. Staging environment testing.'),
('10000000-0001-0000-0000-000000000030', '00000000-0000-0000-0001-000000000001', NULL, 'CC9.1', 'Risk Mitigation', 'The entity identifies, selects, and develops risk mitigation activities', 'risk-mitigation', 'high', false, 'Document risk treatment decisions. Implement compensating controls. Track risk acceptance.'),
('10000000-0001-0000-0000-000000000031', '00000000-0000-0000-0001-000000000001', NULL, 'CC9.2', 'Vendor Risk Management', 'The entity assesses and manages risks associated with vendors and business partners', 'risk-mitigation', 'high', false, 'Vendor security assessments. Contract security requirements. Ongoing vendor monitoring.'),

-- Availability
('10000000-0001-0000-0000-000000000032', '00000000-0000-0000-0001-000000000001', NULL, 'A1.1', 'Capacity Planning', 'The entity maintains, monitors, and evaluates current processing capacity and use of system components', 'availability', 'high', true, 'Monitor resource utilization. Auto-scaling policies. Capacity planning reviews.'),
('10000000-0001-0000-0000-000000000033', '00000000-0000-0000-0001-000000000001', NULL, 'A1.2', 'Recovery Procedures', 'The entity authorizes, designs, develops, implements, and monitors environmental protections and recovery procedures', 'availability', 'critical', false, 'Backup procedures. DR site. Recovery testing. RPO/RTO documentation.'),
('10000000-0001-0000-0000-000000000034', '00000000-0000-0000-0001-000000000001', NULL, 'A1.3', 'Recovery Testing', 'The entity tests recovery plan procedures supporting system recovery', 'availability', 'high', false, 'Annual DR testing. Document test results. Update plans based on findings.'),

-- Confidentiality
('10000000-0001-0000-0000-000000000035', '00000000-0000-0000-0001-000000000001', NULL, 'C1.1', 'Confidential Information Identification', 'The entity identifies and maintains confidential information', 'confidentiality', 'high', false, 'Data classification scheme. Label confidential data. Inventory of confidential assets.'),
('10000000-0001-0000-0000-000000000036', '00000000-0000-0000-0001-000000000001', NULL, 'C1.2', 'Confidential Information Disposal', 'The entity disposes of confidential information to meet objectives', 'confidentiality', 'high', false, 'Data retention schedule. Secure deletion procedures. Certificate of destruction.')

ON CONFLICT DO NOTHING;

-- ============================================================
-- ISO 27001:2022 CONTROLS (Annex A - Key controls)
-- ============================================================
INSERT INTO public.compliance_controls (id, framework_id, company_id, control_ref, title, description, category, severity, automated, implementation_guidance)
VALUES
('10000000-0002-0000-0000-000000000001', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.1', 'Policies for Information Security', 'Information security policy and topic-specific policies shall be defined, approved, published, and communicated', 'organizational', 'high', false, 'Create and publish information security policy. Annual review cycle.'),
('10000000-0002-0000-0000-000000000002', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.2', 'Information Security Roles', 'Information security roles and responsibilities shall be defined and allocated', 'organizational', 'high', false, 'Define CISO/security lead role. RACI matrix for security responsibilities.'),
('10000000-0002-0000-0000-000000000003', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.3', 'Segregation of Duties', 'Conflicting duties and areas of responsibility shall be segregated', 'organizational', 'high', true, 'Separate development, testing, and production roles. No single-person approvals for critical changes.'),
('10000000-0002-0000-0000-000000000004', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.10', 'Acceptable Use of Assets', 'Rules for acceptable use of information and assets shall be identified and documented', 'organizational', 'medium', false, 'Acceptable use policy. Employee acknowledgment tracking.'),
('10000000-0002-0000-0000-000000000005', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.15', 'Access Control', 'Rules to control physical and logical access shall be established based on business and security requirements', 'organizational', 'critical', true, 'Access control policy. Role-based access. Least privilege principle.'),
('10000000-0002-0000-0000-000000000006', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.23', 'Cloud Service Security', 'Processes for acquisition, use, management, and exit from cloud services shall be established', 'organizational', 'high', true, 'Cloud security policy. Provider assessments. Shared responsibility documentation.'),
('10000000-0002-0000-0000-000000000007', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.24', 'Incident Management Planning', 'Management responsibilities and procedures shall be established for incident response', 'organizational', 'critical', false, 'Incident response plan. Contact lists. Communication templates.'),
('10000000-0002-0000-0000-000000000008', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.29', 'ICT Readiness for BC', 'ICT readiness shall be planned, implemented, maintained, and tested based on business continuity objectives', 'organizational', 'high', false, 'Business continuity plan. ICT DR procedures. Annual testing.'),
('10000000-0002-0000-0000-000000000009', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.30', 'ICT Readiness Testing', 'ICT readiness for business continuity shall be tested and reviewed regularly', 'organizational', 'high', false, 'Annual BC/DR testing. Document results. Update plans based on findings.'),
('10000000-0002-0000-0000-000000000010', '00000000-0000-0000-0001-000000000002', NULL, 'A.5.31', 'Legal and Regulatory Requirements', 'Legal, statutory, regulatory, and contractual requirements relevant to information security shall be identified', 'organizational', 'high', false, 'Maintain regulatory register. Regular compliance reviews. Legal counsel engagement.'),
('10000000-0002-0000-0000-000000000011', '00000000-0000-0000-0001-000000000002', NULL, 'A.6.1', 'Screening', 'Background verification checks on candidates shall be carried out prior to joining', 'people', 'high', false, 'Background check process. Reference verification. Criminal record checks where permitted.'),
('10000000-0002-0000-0000-000000000012', '00000000-0000-0000-0001-000000000002', NULL, 'A.6.2', 'Terms of Employment', 'Employment agreements shall state responsibilities for information security', 'people', 'high', false, 'Include security clauses in employment contracts. NDA/confidentiality agreements.'),
('10000000-0002-0000-0000-000000000013', '00000000-0000-0000-0001-000000000002', NULL, 'A.6.3', 'Security Awareness Training', 'Personnel shall receive appropriate security awareness education and training', 'people', 'critical', false, 'Annual security training. Track completion. Role-specific training for IT staff.'),
('10000000-0002-0000-0000-000000000014', '00000000-0000-0000-0001-000000000002', NULL, 'A.6.5', 'Responsibilities After Termination', 'Information security responsibilities valid after termination or change of employment shall be defined and enforced', 'people', 'high', true, 'Offboarding checklist. Access revocation within 24h. Return of assets.'),
('10000000-0002-0000-0000-000000000015', '00000000-0000-0000-0001-000000000002', NULL, 'A.7.1', 'Physical Security Perimeters', 'Security perimeters shall be defined and used to protect areas containing information and assets', 'physical', 'medium', false, 'Office access controls. Visitor management. CCTV monitoring.'),
('10000000-0002-0000-0000-000000000016', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.1', 'User Endpoint Devices', 'Information stored on, processed by, or accessible via user endpoint devices shall be protected', 'technological', 'critical', true, 'MDM enrollment. Disk encryption. Screen lock. Automatic updates.'),
('10000000-0002-0000-0000-000000000017', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.2', 'Privileged Access Rights', 'The allocation and use of privileged access rights shall be restricted and managed', 'technological', 'critical', true, 'Minimal admin accounts. Just-in-time access. Privileged access monitoring.'),
('10000000-0002-0000-0000-000000000018', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.3', 'Information Access Restriction', 'Access to information shall be restricted in accordance with the access control policy', 'technological', 'critical', true, 'RBAC implementation. Data access logging. Periodic access reviews.'),
('10000000-0002-0000-0000-000000000019', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.5', 'Secure Authentication', 'Secure authentication technologies and procedures shall be established', 'technological', 'critical', true, 'MFA enforcement. Password policy. SSO implementation.'),
('10000000-0002-0000-0000-000000000020', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.9', 'Configuration Management', 'Configurations of hardware, software, services, and networks shall be established and managed', 'technological', 'high', true, 'Baseline configurations. Configuration drift detection. Hardening standards.'),
('10000000-0002-0000-0000-000000000021', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.10', 'Information Deletion', 'Information stored in systems and devices shall be deleted when no longer required', 'technological', 'high', false, 'Data retention policy. Automated purging. Deletion verification.'),
('10000000-0002-0000-0000-000000000022', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.12', 'Data Leakage Prevention', 'Data leakage prevention measures shall be applied to systems and networks that process sensitive information', 'technological', 'high', true, 'DLP tool implementation. Email scanning. Endpoint DLP.'),
('10000000-0002-0000-0000-000000000023', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.15', 'Logging', 'Logs that record activities, exceptions, faults, and other relevant events shall be produced and stored', 'technological', 'critical', true, 'Centralized logging. Log retention policy. Tamper protection for logs.'),
('10000000-0002-0000-0000-000000000024', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.16', 'Monitoring Activities', 'Networks, systems, and applications shall be monitored for anomalous behaviour', 'technological', 'critical', true, 'SIEM/monitoring tools. Alert rules. Anomaly detection.'),
('10000000-0002-0000-0000-000000000025', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.20', 'Network Security', 'Networks and network devices shall be secured, managed, and controlled', 'technological', 'high', true, 'Firewall management. Network segmentation. Secure network architecture.'),
('10000000-0002-0000-0000-000000000026', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.24', 'Use of Cryptography', 'Rules for the effective use of cryptography including key management shall be defined', 'technological', 'critical', true, 'Encryption at rest and in transit. Key management procedures. TLS 1.2+ enforcement.'),
('10000000-0002-0000-0000-000000000027', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.25', 'Secure Development Lifecycle', 'Rules for the secure development of software and systems shall be established', 'technological', 'high', true, 'SDLC documentation. Code review. SAST/DAST scanning. Dependency management.'),
('10000000-0002-0000-0000-000000000028', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.28', 'Secure Coding', 'Secure coding principles shall be applied to software development', 'technological', 'high', true, 'Coding standards. OWASP guidelines. Input validation. Output encoding.'),
('10000000-0002-0000-0000-000000000029', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.31', 'Separation of Environments', 'Development, testing, and production environments shall be separated', 'technological', 'high', true, 'Separate environments. No production data in dev/test. Environment isolation.'),
('10000000-0002-0000-0000-000000000030', '00000000-0000-0000-0001-000000000002', NULL, 'A.8.34', 'Protection of Test Information', 'Test information shall be appropriately selected, protected, and managed', 'technological', 'medium', false, 'Test data anonymization. No PII in test environments. Synthetic data generation.')

ON CONFLICT DO NOTHING;

-- ============================================================
-- GDPR CONTROLS (Key Articles)
-- ============================================================
INSERT INTO public.compliance_controls (id, framework_id, company_id, control_ref, title, description, category, severity, automated, implementation_guidance)
VALUES
('10000000-0003-0000-0000-000000000001', '00000000-0000-0000-0001-000000000003', NULL, 'Art.5', 'Principles of Processing', 'Personal data must be processed lawfully, fairly, and transparently', 'principles', 'critical', false, 'Document lawful basis for each processing activity. Privacy notices. Data minimization review.'),
('10000000-0003-0000-0000-000000000002', '00000000-0000-0000-0001-000000000003', NULL, 'Art.6', 'Lawful Basis', 'Processing must have a valid legal basis (consent, contract, legal obligation, vital interest, public task, legitimate interest)', 'principles', 'critical', false, 'Map each processing activity to a lawful basis. Document legitimate interest assessments.'),
('10000000-0003-0000-0000-000000000003', '00000000-0000-0000-0001-000000000003', NULL, 'Art.7', 'Consent Management', 'Where consent is the lawful basis, it must be freely given, specific, informed, and unambiguous', 'consent', 'critical', true, 'Consent management platform. Granular consent options. Easy withdrawal mechanism.'),
('10000000-0003-0000-0000-000000000004', '00000000-0000-0000-0001-000000000003', NULL, 'Art.12', 'Transparent Communication', 'Information about processing must be provided in a concise, transparent, intelligible, and easily accessible form', 'rights', 'high', false, 'Privacy policy review. Layered privacy notices. Plain language requirement.'),
('10000000-0003-0000-0000-000000000005', '00000000-0000-0000-0001-000000000003', NULL, 'Art.13-14', 'Information Provision', 'Data subjects must be informed of processing purposes, legal basis, retention periods, and rights', 'rights', 'high', false, 'Privacy notices at collection points. Cover all Article 13/14 requirements.'),
('10000000-0003-0000-0000-000000000006', '00000000-0000-0000-0001-000000000003', NULL, 'Art.15', 'Right of Access (SAR)', 'Data subjects have the right to obtain confirmation of processing and access to their personal data', 'rights', 'critical', false, 'SAR handling process. Identity verification. Response within 30 days.'),
('10000000-0003-0000-0000-000000000007', '00000000-0000-0000-0001-000000000003', NULL, 'Art.17', 'Right to Erasure', 'Data subjects have the right to have their personal data erased under certain conditions', 'rights', 'critical', true, 'Erasure request workflow. Automated data deletion. Verification of completion.'),
('10000000-0003-0000-0000-000000000008', '00000000-0000-0000-0001-000000000003', NULL, 'Art.20', 'Data Portability', 'Data subjects have the right to receive their data in a structured, commonly used format', 'rights', 'high', true, 'Data export functionality. Machine-readable format (JSON/CSV). Automated export.'),
('10000000-0003-0000-0000-000000000009', '00000000-0000-0000-0001-000000000003', NULL, 'Art.25', 'Data Protection by Design', 'Data protection measures must be integrated into processing activities from the design stage', 'technical', 'critical', false, 'Privacy by design checklist for new features. DPIA triggers. Default privacy settings.'),
('10000000-0003-0000-0000-000000000010', '00000000-0000-0000-0001-000000000003', NULL, 'Art.28', 'Processor Requirements', 'Controllers must use processors providing sufficient guarantees and proper DPA must be in place', 'processors', 'critical', false, 'Data Processing Agreements with all processors. Processor audit rights. Subprocessor management.'),
('10000000-0003-0000-0000-000000000011', '00000000-0000-0000-0001-000000000003', NULL, 'Art.30', 'Records of Processing', 'Maintain a record of processing activities (ROPA) with all required details', 'accountability', 'critical', false, 'Processing activity register. Regular updates. Cover all Article 30 fields.'),
('10000000-0003-0000-0000-000000000012', '00000000-0000-0000-0001-000000000003', NULL, 'Art.32', 'Security of Processing', 'Implement appropriate technical and organizational measures to ensure security of personal data', 'technical', 'critical', true, 'Encryption. Pseudonymization. Access controls. Regular testing. Incident detection.'),
('10000000-0003-0000-0000-000000000013', '00000000-0000-0000-0001-000000000003', NULL, 'Art.33', 'Breach Notification to Authority', 'Notify the supervisory authority within 72 hours of becoming aware of a personal data breach', 'breach', 'critical', false, 'Breach detection process. Notification templates. 72-hour procedure. Authority contact details.'),
('10000000-0003-0000-0000-000000000014', '00000000-0000-0000-0001-000000000003', NULL, 'Art.34', 'Breach Notification to Individuals', 'Communicate personal data breaches to affected individuals when likely to result in high risk', 'breach', 'critical', false, 'Individual notification templates. Risk assessment criteria. Communication channels.'),
('10000000-0003-0000-0000-000000000015', '00000000-0000-0000-0001-000000000003', NULL, 'Art.35', 'Data Protection Impact Assessment', 'Conduct DPIA when processing is likely to result in high risk to individuals', 'accountability', 'critical', false, 'DPIA template and process. Trigger criteria. DPO consultation. Publish DPIA summaries.'),
('10000000-0003-0000-0000-000000000016', '00000000-0000-0000-0001-000000000003', NULL, 'Art.37', 'Data Protection Officer', 'Appoint DPO when required by regulation or when processing sensitive data at scale', 'accountability', 'high', false, 'DPO appointment. Independence. Direct reporting to management. Contact details published.'),
('10000000-0003-0000-0000-000000000017', '00000000-0000-0000-0001-000000000003', NULL, 'Art.44-49', 'International Transfers', 'Personal data transfers outside EEA require appropriate safeguards', 'transfers', 'critical', false, 'Transfer impact assessments. Standard Contractual Clauses. Adequacy decisions. Binding Corporate Rules.'),
('10000000-0003-0000-0000-000000000018', '00000000-0000-0000-0001-000000000003', NULL, 'Art.47', 'Binding Corporate Rules', 'Legally binding internal rules for international transfers within a corporate group', 'transfers', 'high', false, 'BCR documentation. DPA approval. Regular review and updates.')

ON CONFLICT DO NOTHING;

-- ============================================================
-- EU AI ACT CONTROLS
-- ============================================================
INSERT INTO public.compliance_controls (id, framework_id, company_id, control_ref, title, description, category, severity, automated, implementation_guidance)
VALUES
('10000000-0004-0000-0000-000000000001', '00000000-0000-0000-0001-000000000004', NULL, 'Art.4', 'AI Literacy', 'Providers and deployers must ensure sufficient AI literacy of their staff', 'governance', 'high', false, 'AI literacy training program. Track completion. Role-specific training for AI developers.'),
('10000000-0004-0000-0000-000000000002', '00000000-0000-0000-0001-000000000004', NULL, 'Art.5', 'Prohibited AI Practices', 'Certain AI practices that pose unacceptable risks are prohibited', 'prohibited', 'critical', false, 'Inventory all AI systems. Screen each against Article 5 prohibitions. Decommission if prohibited.'),
('10000000-0004-0000-0000-000000000003', '00000000-0000-0000-0001-000000000004', NULL, 'Art.6', 'Classification of High-Risk AI', 'AI systems falling under Annex I or Annex III are classified as high-risk', 'classification', 'critical', false, 'Classify each AI system per Annex I and III criteria. Document classification rationale.'),
('10000000-0004-0000-0000-000000000004', '00000000-0000-0000-0001-000000000004', NULL, 'Art.9', 'Risk Management System', 'High-risk AI systems require a continuous risk management system throughout their lifecycle', 'risk', 'critical', false, 'Risk management framework for each high-risk system. Continuous monitoring. Regular updates.'),
('10000000-0004-0000-0000-000000000005', '00000000-0000-0000-0001-000000000004', NULL, 'Art.10', 'Data Governance', 'Training, validation, and testing data sets must meet quality criteria', 'data', 'critical', false, 'Data quality framework. Bias detection. Representative datasets. Data documentation.'),
('10000000-0004-0000-0000-000000000006', '00000000-0000-0000-0001-000000000004', NULL, 'Art.11', 'Technical Documentation', 'Comprehensive technical documentation must be drawn up before market placement', 'documentation', 'critical', false, 'Annex IV technical documentation for each high-risk system. Keep updated throughout lifecycle.'),
('10000000-0004-0000-0000-000000000007', '00000000-0000-0000-0001-000000000004', NULL, 'Art.12', 'Record-Keeping', 'High-risk AI systems shall allow automatic recording of events (logs)', 'transparency', 'critical', true, 'Implement logging for all AI system decisions. Retain logs per Annex IV requirements. Tamper protection.'),
('10000000-0004-0000-0000-000000000008', '00000000-0000-0000-0001-000000000004', NULL, 'Art.13', 'Transparency and Information', 'High-risk AI systems shall be designed to ensure sufficient transparency for deployers', 'transparency', 'critical', false, 'Instructions for use document. Performance metrics disclosure. Limitations documentation.'),
('10000000-0004-0000-0000-000000000009', '00000000-0000-0000-0001-000000000004', NULL, 'Art.14', 'Human Oversight', 'High-risk AI systems shall be designed to allow effective human oversight', 'oversight', 'critical', false, 'Human-in-the-loop design. Override mechanisms. Clear escalation procedures.'),
('10000000-0004-0000-0000-000000000010', '00000000-0000-0000-0001-000000000004', NULL, 'Art.15', 'Accuracy, Robustness, Security', 'High-risk AI systems shall achieve appropriate levels of accuracy, robustness, and cybersecurity', 'technical', 'critical', true, 'Performance benchmarks. Adversarial testing. Cybersecurity measures. Regular accuracy evaluation.'),
('10000000-0004-0000-0000-000000000011', '00000000-0000-0000-0001-000000000004', NULL, 'Art.16', 'Provider Obligations', 'Providers of high-risk AI must ensure compliance with all Chapter 2 requirements', 'governance', 'critical', false, 'Quality management system. Conformity assessment. EU Declaration of Conformity. CE marking.'),
('10000000-0004-0000-0000-000000000012', '00000000-0000-0000-0001-000000000004', NULL, 'Art.17', 'Quality Management System', 'Providers must establish a quality management system documented in policies and procedures', 'governance', 'critical', false, 'QMS covering risk management, data governance, record-keeping, and post-market monitoring.'),
('10000000-0004-0000-0000-000000000013', '00000000-0000-0000-0001-000000000004', NULL, 'Art.26', 'Deployer Obligations', 'Deployers of high-risk AI must use systems in accordance with instructions and monitor operation', 'governance', 'critical', false, 'Follow provider instructions. Monitor AI system performance. Report incidents. DPIA when required.'),
('10000000-0004-0000-0000-000000000014', '00000000-0000-0000-0001-000000000004', NULL, 'Art.47', 'EU Declaration of Conformity', 'Providers must draw up an EU declaration of conformity for each high-risk AI system', 'documentation', 'critical', false, 'Declaration template per Annex V. Keep updated. Available to authorities for 10 years.'),
('10000000-0004-0000-0000-000000000015', '00000000-0000-0000-0001-000000000004', NULL, 'Art.49', 'CE Marking', 'High-risk AI systems must bear the CE marking indicating conformity', 'documentation', 'high', false, 'CE marking on system or documentation. Visible, legible, indelible.'),
('10000000-0004-0000-0000-000000000016', '00000000-0000-0000-0001-000000000004', NULL, 'Art.50', 'Transparency for Limited Risk', 'Certain AI systems must disclose to users that they are interacting with AI', 'transparency', 'high', false, 'AI disclosure notices. Synthetic content labeling. Emotion recognition disclosure. Deepfake labeling.'),
('10000000-0004-0000-0000-000000000017', '00000000-0000-0000-0001-000000000004', NULL, 'Art.52-55', 'GPAI Obligations', 'General-purpose AI model providers must meet transparency and documentation requirements', 'gpai', 'critical', false, 'Technical documentation. Training data summary. Copyright policy. Downstream provider information.'),
('10000000-0004-0000-0000-000000000018', '00000000-0000-0000-0001-000000000004', NULL, 'Art.72', 'Post-Market Monitoring', 'Providers must establish a post-market monitoring system proportionate to the AI system', 'monitoring', 'critical', true, 'Monitoring plan. Performance tracking. User feedback collection. Incident reporting.'),
('10000000-0004-0000-0000-000000000019', '00000000-0000-0000-0001-000000000004', NULL, 'Art.73', 'Serious Incident Reporting', 'Providers and deployers must report serious incidents to market surveillance authorities', 'incidents', 'critical', false, 'Serious incident definition. Reporting process. Timeframes (immediately for life-threatening, 15 days otherwise).')

ON CONFLICT DO NOTHING;
